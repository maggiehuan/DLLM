parsed:  
Config:
configs:  [crafter]  (strs) 
remaining: ['--run.script', 'train_eval', '--use_wandb', 'True', '--logdir', '/home/ziyu/logdir/ziyu_crafter_cuda_1_seed_1']
parsed:  
Config:
use_wandb:                  True                                          (bool)
seed:                       1                                             (int)
method:                     name                                          (str)
task:                       crafter_reward                                (str)
logdir:                     /home/ziyu/logdir/ziyu_crafter_cuda_1_seed_1  (str)
replay:                     uniform                                       (str)
replay_size:                1000000.0                                     (float)
replay_online:              False                                         (bool)
eval_dir:                                                                 (str)
filter:                     .*                                            (str)
jax.platform:               gpu                                           (str)
jax.jit:                    True                                          (bool)
jax.precision:              float16                                       (str)
jax.prealloc:               True                                          (bool)
jax.debug_nans:             False                                         (bool)
jax.logical_cpus:           0                                             (int)
jax.debug:                  False                                         (bool)
jax.policy_devices:         [0]                                           (ints)
jax.train_devices:          [0]                                           (ints)
jax.metrics_every:          10                                            (int)
run.script:                 train_eval                                    (str)
run.steps:                  10000000000.0                                 (float)
run.expl_until:             0                                             (int)
run.log_every:              300                                           (int)
run.save_every:             900                                           (int)
run.eval_every:             1000000.0                                     (float)
run.eval_initial:           True                                          (bool)
run.eval_eps:               1                                             (int)
run.eval_samples:           1                                             (int)
run.train_ratio:            512.0                                         (float)
run.train_fill:             0                                             (int)
run.eval_fill:              0                                             (int)
run.log_zeros:              False                                         (bool)
run.log_keys_video:         [image]                                       (strs)
run.log_keys_sum:           ^log_reward$                                  (str)
run.log_keys_mean:          (log_entropy)                                 (str)
run.log_keys_max:           ^log_achievement_.*                           (str)
run.from_checkpoint:                                                      (str)
run.sync_every:             10                                            (int)
run.actor_addr:             ipc:///tmp/5551                               (str)
run.actor_batch:            32                                            (int)
envs.amount:                1                                             (int)
envs.parallel:              process                                       (str)
envs.length:                0                                             (int)
envs.reset:                 True                                          (bool)
envs.restart:               True                                          (bool)
envs.discretize:            0                                             (int)
envs.checks:                False                                         (bool)
wrapper.length:             0                                             (int)
wrapper.reset:              True                                          (bool)
wrapper.discretize:         0                                             (int)
wrapper.checks:             False                                         (bool)
env.atari.size:             [64, 64]                                      (ints)
env.atari.repeat:           4                                             (int)
env.atari.sticky:           True                                          (bool)
env.atari.gray:             False                                         (bool)
env.atari.actions:          all                                           (str)
env.atari.lives:            unused                                        (str)
env.atari.noops:            0                                             (int)
env.atari.resize:           opencv                                        (str)
env.dmlab.size:             [64, 64]                                      (ints)
env.dmlab.repeat:           4                                             (int)
env.dmlab.episodic:         True                                          (bool)
env.minecraft.size:         [64, 64]                                      (ints)
env.minecraft.break_speed:  100.0                                         (float)
env.dmc.size:               [64, 64]                                      (ints)
env.dmc.repeat:             2                                             (int)
env.dmc.camera:             -1                                            (int)
env.loconav.size:           [64, 64]                                      (ints)
env.loconav.repeat:         2                                             (int)
env.loconav.camera:         -1                                            (int)
task_behavior:              Greedy                                        (str)
expl_behavior:              None                                          (str)
batch_size:                 16                                            (int)
batch_length:               64                                            (int)
data_loaders:               8                                             (int)
grad_heads:                 [decoder, reward, cont]                       (strs)
rssm.deter:                 4096                                          (int)
rssm.units:                 1024                                          (int)
rssm.stoch:                 32                                            (int)
rssm.classes:               32                                            (int)
rssm.act:                   silu                                          (str)
rssm.norm:                  layer                                         (str)
rssm.initial:               learned                                       (str)
rssm.unimix:                0.01                                          (float)
rssm.unroll:                False                                         (bool)
rssm.action_clip:           1.0                                           (float)
rssm.winit:                 normal                                        (str)
rssm.fan:                   avg                                           (str)
encoder.mlp_keys:           transition_tokens                             (str)
encoder.cnn_keys:           image                                         (str)
encoder.act:                silu                                          (str)
encoder.norm:               layer                                         (str)
encoder.mlp_layers:         5                                             (int)
encoder.mlp_units:          1024                                          (int)
encoder.cnn:                resnet                                        (str)
encoder.cnn_depth:          96                                            (int)
encoder.cnn_blocks:         0                                             (int)
encoder.resize:             stride                                        (str)
encoder.winit:              normal                                        (str)
encoder.fan:                avg                                           (str)
encoder.symlog_inputs:      True                                          (bool)
encoder.minres:             4                                             (int)
decoder.mlp_keys:           transition_tokens                             (str)
decoder.cnn_keys:           image                                         (str)
decoder.act:                silu                                          (str)
decoder.norm:               layer                                         (str)
decoder.mlp_layers:         5                                             (int)
decoder.mlp_units:          1024                                          (int)
decoder.cnn:                resnet                                        (str)
decoder.cnn_depth:          96                                            (int)
decoder.cnn_blocks:         0                                             (int)
decoder.image_dist:         mse                                           (str)
decoder.vector_dist:        symlog_mse                                    (str)
decoder.inputs:             [deter, stoch]                                (strs)
decoder.resize:             stride                                        (str)
decoder.winit:              normal                                        (str)
decoder.fan:                avg                                           (str)
decoder.outscale:           1.0                                           (float)
decoder.minres:             4                                             (int)
decoder.cnn_sigmoid:        False                                         (bool)
reward_head.layers:         5                                             (int)
reward_head.units:          1024                                          (int)
reward_head.act:            silu                                          (str)
reward_head.norm:           layer                                         (str)
reward_head.dist:           symlog_disc                                   (str)
reward_head.outscale:       0.0                                           (float)
reward_head.outnorm:        False                                         (bool)
reward_head.inputs:         [deter, stoch]                                (strs)
reward_head.winit:          normal                                        (str)
reward_head.fan:            avg                                           (str)
reward_head.bins:           255                                           (int)
cont_head.layers:           5                                             (int)
cont_head.units:            1024                                          (int)
cont_head.act:              silu                                          (str)
cont_head.norm:             layer                                         (str)
cont_head.dist:             binary                                        (str)
cont_head.outscale:         1.0                                           (float)
cont_head.outnorm:          False                                         (bool)
cont_head.inputs:           [deter, stoch]                                (strs)
cont_head.winit:            normal                                        (str)
cont_head.fan:              avg                                           (str)
loss_scales.image:          1.0                                           (float)
loss_scales.vector:         1.0                                           (float)
loss_scales.reward:         1.0                                           (float)
loss_scales.cont:           1.0                                           (float)
loss_scales.dyn:            0.5                                           (float)
loss_scales.rep:            0.1                                           (float)
loss_scales.actor:          1.0                                           (float)
loss_scales.critic:         1.0                                           (float)
loss_scales.slowreg:        1.0                                           (float)
dyn_loss.impl:              kl                                            (str)
dyn_loss.free:              1.0                                           (float)
rep_loss.impl:              kl                                            (str)
rep_loss.free:              1.0                                           (float)
model_opt.opt:              adam                                          (str)
model_opt.lr:               0.0001                                        (float)
model_opt.eps:              1e-08                                         (float)
model_opt.clip:             1000.0                                        (float)
model_opt.wd:               0.0                                           (float)
model_opt.warmup:           0                                             (int)
model_opt.lateclip:         0.0                                           (float)
actor.layers:               5                                             (int)
actor.units:                1024                                          (int)
actor.act:                  silu                                          (str)
actor.norm:                 layer                                         (str)
actor.minstd:               0.1                                           (float)
actor.maxstd:               1.0                                           (float)
actor.outscale:             1.0                                           (float)
actor.outnorm:              False                                         (bool)
actor.unimix:               0.01                                          (float)
actor.inputs:               [deter, stoch]                                (strs)
actor.winit:                normal                                        (str)
actor.fan:                  avg                                           (str)
actor.symlog_inputs:        False                                         (bool)
critic.layers:              5                                             (int)
critic.units:               1024                                          (int)
critic.act:                 silu                                          (str)
critic.norm:                layer                                         (str)
critic.dist:                symlog_disc                                   (str)
critic.outscale:            0.0                                           (float)
critic.outnorm:             False                                         (bool)
critic.inputs:              [deter, stoch]                                (strs)
critic.winit:               normal                                        (str)
critic.fan:                 avg                                           (str)
critic.bins:                255                                           (int)
critic.symlog_inputs:       False                                         (bool)
actor_opt.opt:              adam                                          (str)
actor_opt.lr:               3e-05                                         (float)
actor_opt.eps:              1e-05                                         (float)
actor_opt.clip:             100.0                                         (float)
actor_opt.wd:               0.0                                           (float)
actor_opt.warmup:           0                                             (int)
actor_opt.lateclip:         0.0                                           (float)
critic_opt.opt:             adam                                          (str)
critic_opt.lr:              3e-05                                         (float)
critic_opt.eps:             1e-05                                         (float)
critic_opt.clip:            100.0                                         (float)
critic_opt.wd:              0.0                                           (float)
critic_opt.warmup:          0                                             (int)
critic_opt.lateclip:        0.0                                           (float)
actor_dist_disc:            onehot                                        (str)
actor_dist_cont:            normal                                        (str)
actor_grad_disc:            reinforce                                     (str)
actor_grad_cont:            backprop                                      (str)
critic_type:                vfunction                                     (str)
imag_horizon:               15                                            (int)
imag_unroll:                False                                         (bool)
horizon:                    333                                           (int)
return_lambda:              0.95                                          (float)
critic_slowreg:             logprob                                       (str)
slow_critic_update:         1                                             (int)
slow_critic_fraction:       0.02                                          (float)
retnorm.impl:               perc_ema                                      (str)
retnorm.decay:              0.99                                          (float)
retnorm.max:                1.0                                           (float)
retnorm.perclo:             5.0                                           (float)
retnorm.perchi:             95.0                                          (float)
actent:                     0.0003                                        (float)
expl_rewards.extr:          1.0                                           (float)
expl_rewards.disag:         0.1                                           (float)
expl_opt.opt:               adam                                          (str)
expl_opt.lr:                0.0001                                        (float)
expl_opt.eps:               1e-05                                         (float)
expl_opt.clip:              100.0                                         (float)
expl_opt.wd:                0.0                                           (float)
expl_opt.warmup:            0                                             (int)
disag_head.layers:          5                                             (int)
disag_head.units:           1024                                          (int)
disag_head.act:             silu                                          (str)
disag_head.norm:            layer                                         (str)
disag_head.dist:            mse                                           (str)
disag_head.outscale:        1.0                                           (float)
disag_head.inputs:          [deter, stoch, action]                        (strs)
disag_head.winit:           normal                                        (str)
disag_head.fan:             avg                                           (str)
disag_target:               [stoch]                                       (strs)
disag_models:               8                                             (int) 
remaining: []

Config:
use_wandb:                  True                                          (bool)
seed:                       1                                             (int)
method:                     name                                          (str)
task:                       crafter_reward                                (str)
logdir:                     /home/ziyu/logdir/ziyu_crafter_cuda_1_seed_1  (str)
replay:                     uniform                                       (str)
replay_size:                1000000.0                                     (float)
replay_online:              False                                         (bool)
eval_dir:                                                                 (str)
filter:                     .*                                            (str)
jax.platform:               gpu                                           (str)
jax.jit:                    True                                          (bool)
jax.precision:              float16                                       (str)
jax.prealloc:               True                                          (bool)
jax.debug_nans:             False                                         (bool)
jax.logical_cpus:           0                                             (int)
jax.debug:                  False                                         (bool)
jax.policy_devices:         [0]                                           (ints)
jax.train_devices:          [0]                                           (ints)
jax.metrics_every:          10                                            (int)
run.script:                 train_eval                                    (str)
run.steps:                  10000000000.0                                 (float)
run.expl_until:             0                                             (int)
run.log_every:              300                                           (int)
run.save_every:             900                                           (int)
run.eval_every:             1000000.0                                     (float)
run.eval_initial:           True                                          (bool)
run.eval_eps:               1                                             (int)
run.eval_samples:           1                                             (int)
run.train_ratio:            512.0                                         (float)
run.train_fill:             0                                             (int)
run.eval_fill:              0                                             (int)
run.log_zeros:              False                                         (bool)
run.log_keys_video:         [image]                                       (strs)
run.log_keys_sum:           ^log_reward$                                  (str)
run.log_keys_mean:          (log_entropy)                                 (str)
run.log_keys_max:           ^log_achievement_.*                           (str)
run.from_checkpoint:                                                      (str)
run.sync_every:             10                                            (int)
run.actor_addr:             ipc:///tmp/5551                               (str)
run.actor_batch:            32                                            (int)
envs.amount:                1                                             (int)
envs.parallel:              process                                       (str)
envs.length:                0                                             (int)
envs.reset:                 True                                          (bool)
envs.restart:               True                                          (bool)
envs.discretize:            0                                             (int)
envs.checks:                False                                         (bool)
wrapper.length:             0                                             (int)
wrapper.reset:              True                                          (bool)
wrapper.discretize:         0                                             (int)
wrapper.checks:             False                                         (bool)
env.atari.size:             [64, 64]                                      (ints)
env.atari.repeat:           4                                             (int)
env.atari.sticky:           True                                          (bool)
env.atari.gray:             False                                         (bool)
env.atari.actions:          all                                           (str)
env.atari.lives:            unused                                        (str)
env.atari.noops:            0                                             (int)
env.atari.resize:           opencv                                        (str)
env.dmlab.size:             [64, 64]                                      (ints)
env.dmlab.repeat:           4                                             (int)
env.dmlab.episodic:         True                                          (bool)
env.minecraft.size:         [64, 64]                                      (ints)
env.minecraft.break_speed:  100.0                                         (float)
env.dmc.size:               [64, 64]                                      (ints)
env.dmc.repeat:             2                                             (int)
env.dmc.camera:             -1                                            (int)
env.loconav.size:           [64, 64]                                      (ints)
env.loconav.repeat:         2                                             (int)
env.loconav.camera:         -1                                            (int)
task_behavior:              Greedy                                        (str)
expl_behavior:              None                                          (str)
batch_size:                 16                                            (int)
batch_length:               64                                            (int)
data_loaders:               8                                             (int)
grad_heads:                 [decoder, reward, cont]                       (strs)
rssm.deter:                 4096                                          (int)
rssm.units:                 1024                                          (int)
rssm.stoch:                 32                                            (int)
rssm.classes:               32                                            (int)
rssm.act:                   silu                                          (str)
rssm.norm:                  layer                                         (str)
rssm.initial:               learned                                       (str)
rssm.unimix:                0.01                                          (float)
rssm.unroll:                False                                         (bool)
rssm.action_clip:           1.0                                           (float)
rssm.winit:                 normal                                        (str)
rssm.fan:                   avg                                           (str)
encoder.mlp_keys:           transition_tokens                             (str)
encoder.cnn_keys:           image                                         (str)
encoder.act:                silu                                          (str)
encoder.norm:               layer                                         (str)
encoder.mlp_layers:         5                                             (int)
encoder.mlp_units:          1024                                          (int)
encoder.cnn:                resnet                                        (str)
encoder.cnn_depth:          96                                            (int)
encoder.cnn_blocks:         0                                             (int)
encoder.resize:             stride                                        (str)
encoder.winit:              normal                                        (str)
encoder.fan:                avg                                           (str)
encoder.symlog_inputs:      True                                          (bool)
encoder.minres:             4                                             (int)
decoder.mlp_keys:           transition_tokens                             (str)
decoder.cnn_keys:           image                                         (str)
decoder.act:                silu                                          (str)
decoder.norm:               layer                                         (str)
decoder.mlp_layers:         5                                             (int)
decoder.mlp_units:          1024                                          (int)
decoder.cnn:                resnet                                        (str)
decoder.cnn_depth:          96                                            (int)
decoder.cnn_blocks:         0                                             (int)
decoder.image_dist:         mse                                           (str)
decoder.vector_dist:        symlog_mse                                    (str)
decoder.inputs:             [deter, stoch]                                (strs)
decoder.resize:             stride                                        (str)
decoder.winit:              normal                                        (str)
decoder.fan:                avg                                           (str)
decoder.outscale:           1.0                                           (float)
decoder.minres:             4                                             (int)
decoder.cnn_sigmoid:        False                                         (bool)
reward_head.layers:         5                                             (int)
reward_head.units:          1024                                          (int)
reward_head.act:            silu                                          (str)
reward_head.norm:           layer                                         (str)
reward_head.dist:           symlog_disc                                   (str)
reward_head.outscale:       0.0                                           (float)
reward_head.outnorm:        False                                         (bool)
reward_head.inputs:         [deter, stoch]                                (strs)
reward_head.winit:          normal                                        (str)
reward_head.fan:            avg                                           (str)
reward_head.bins:           255                                           (int)
cont_head.layers:           5                                             (int)
cont_head.units:            1024                                          (int)
cont_head.act:              silu                                          (str)
cont_head.norm:             layer                                         (str)
cont_head.dist:             binary                                        (str)
cont_head.outscale:         1.0                                           (float)
cont_head.outnorm:          False                                         (bool)
cont_head.inputs:           [deter, stoch]                                (strs)
cont_head.winit:            normal                                        (str)
cont_head.fan:              avg                                           (str)
loss_scales.image:          1.0                                           (float)
loss_scales.vector:         1.0                                           (float)
loss_scales.reward:         1.0                                           (float)
loss_scales.cont:           1.0                                           (float)
loss_scales.dyn:            0.5                                           (float)
loss_scales.rep:            0.1                                           (float)
loss_scales.actor:          1.0                                           (float)
loss_scales.critic:         1.0                                           (float)
loss_scales.slowreg:        1.0                                           (float)
dyn_loss.impl:              kl                                            (str)
dyn_loss.free:              1.0                                           (float)
rep_loss.impl:              kl                                            (str)
rep_loss.free:              1.0                                           (float)
model_opt.opt:              adam                                          (str)
model_opt.lr:               0.0001                                        (float)
model_opt.eps:              1e-08                                         (float)
model_opt.clip:             1000.0                                        (float)
model_opt.wd:               0.0                                           (float)
model_opt.warmup:           0                                             (int)
model_opt.lateclip:         0.0                                           (float)
actor.layers:               5                                             (int)
actor.units:                1024                                          (int)
actor.act:                  silu                                          (str)
actor.norm:                 layer                                         (str)
actor.minstd:               0.1                                           (float)
actor.maxstd:               1.0                                           (float)
actor.outscale:             1.0                                           (float)
actor.outnorm:              False                                         (bool)
actor.unimix:               0.01                                          (float)
actor.inputs:               [deter, stoch]                                (strs)
actor.winit:                normal                                        (str)
actor.fan:                  avg                                           (str)
actor.symlog_inputs:        False                                         (bool)
critic.layers:              5                                             (int)
critic.units:               1024                                          (int)
critic.act:                 silu                                          (str)
critic.norm:                layer                                         (str)
critic.dist:                symlog_disc                                   (str)
critic.outscale:            0.0                                           (float)
critic.outnorm:             False                                         (bool)
critic.inputs:              [deter, stoch]                                (strs)
critic.winit:               normal                                        (str)
critic.fan:                 avg                                           (str)
critic.bins:                255                                           (int)
critic.symlog_inputs:       False                                         (bool)
actor_opt.opt:              adam                                          (str)
actor_opt.lr:               3e-05                                         (float)
actor_opt.eps:              1e-05                                         (float)
actor_opt.clip:             100.0                                         (float)
actor_opt.wd:               0.0                                           (float)
actor_opt.warmup:           0                                             (int)
actor_opt.lateclip:         0.0                                           (float)
critic_opt.opt:             adam                                          (str)
critic_opt.lr:              3e-05                                         (float)
critic_opt.eps:             1e-05                                         (float)
critic_opt.clip:            100.0                                         (float)
critic_opt.wd:              0.0                                           (float)
critic_opt.warmup:          0                                             (int)
critic_opt.lateclip:        0.0                                           (float)
actor_dist_disc:            onehot                                        (str)
actor_dist_cont:            normal                                        (str)
actor_grad_disc:            reinforce                                     (str)
actor_grad_cont:            backprop                                      (str)
critic_type:                vfunction                                     (str)
imag_horizon:               15                                            (int)
imag_unroll:                False                                         (bool)
horizon:                    333                                           (int)
return_lambda:              0.95                                          (float)
critic_slowreg:             logprob                                       (str)
slow_critic_update:         1                                             (int)
slow_critic_fraction:       0.02                                          (float)
retnorm.impl:               perc_ema                                      (str)
retnorm.decay:              0.99                                          (float)
retnorm.max:                1.0                                           (float)
retnorm.perclo:             5.0                                           (float)
retnorm.perchi:             95.0                                          (float)
actent:                     0.0003                                        (float)
expl_rewards.extr:          1.0                                           (float)
expl_rewards.disag:         0.1                                           (float)
expl_opt.opt:               adam                                          (str)
expl_opt.lr:                0.0001                                        (float)
expl_opt.eps:               1e-05                                         (float)
expl_opt.clip:              100.0                                         (float)
expl_opt.wd:                0.0                                           (float)
expl_opt.warmup:            0                                             (int)
disag_head.layers:          5                                             (int)
disag_head.units:           1024                                          (int)
disag_head.act:             silu                                          (str)
disag_head.norm:            layer                                         (str)
disag_head.dist:            mse                                           (str)
disag_head.outscale:        1.0                                           (float)
disag_head.inputs:          [deter, stoch, action]                        (strs)
disag_head.winit:           normal                                        (str)
disag_head.fan:             avg                                           (str)
disag_target:               [stoch]                                       (strs)
disag_models:               8                                             (int)wandb: Currently logged in as: ibisbill326 (ibisbill326-gmail-com). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.1 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.0
wandb: Run data is saved locally in /home/ziyu/code/side_codes/Dynamic_model/DLLM-ziyu/wandb/run-20240102_175159-slcs4ech
wandb: Run `wandb offline` to turn off syncing.
wandb: Resuming run ziyu_crafter_cuda_1_seed_1
wandb: ⭐️ View project at https://wandb.ai/ibisbill326-gmail-com/crafter_reward
wandb: 🚀 View run at https://wandb.ai/ibisbill326-gmail-com/crafter_reward/runs/slcs4ech

!! Resuming wandb run !!
Encoder CNN shapes: {'image': (64, 64, 3)}
Encoder MLP shapes: {'transition_tokens': (384,)}
Decoder CNN shapes: {'image': (64, 64, 3)}
Decoder MLP shapes: {'transition_tokens': (384,)}
JAX devices (1): [cuda(id=0)]
Policy devices: cuda:0
Train devices:  cuda:0
Tracing train function.
no rnd data in data
Optimizer model_opt has 197,057,283 variables.
Optimizer actor_opt has 9,464,849 variables.
Optimizer critic_opt has 9,708,799 variables.
Logdir /home/ziyu/logdir/ziyu_crafter_cuda_1_seed_1
Observation space:
  image            Space(dtype=uint8, shape=(64, 64, 3), low=0, high=255)
  transition_tokens Space(dtype=uint32, shape=(384,), low=0, high=4294967295)
  goal_tokens      Space(dtype=uint32, shape=(5, 384), low=0, high=4294967295)
  goal_id          Space(dtype=uint32, shape=(5,), low=0, high=4294967295)
  reward           Space(dtype=float32, shape=(), low=-inf, high=inf)
  is_first         Space(dtype=bool, shape=(), low=False, high=True)
  is_last          Space(dtype=bool, shape=(), low=False, high=True)
  is_terminal      Space(dtype=bool, shape=(), low=False, high=True)
  log_reward       Space(dtype=float32, shape=(1,), low=-inf, high=inf)
  log_achievement_collect_coal Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_collect_diamond Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_collect_drink Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_collect_iron Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_collect_sapling Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_collect_stone Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_collect_wood Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_defeat_skeleton Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_defeat_zombie Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_eat_cow Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_eat_plant Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_make_iron_pickaxe Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_make_iron_sword Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_make_stone_pickaxe Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_make_stone_sword Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_make_wood_pickaxe Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_make_wood_sword Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_place_furnace Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_place_plant Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_place_stone Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_place_table Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_wake_up Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
Action space:
  action           Space(dtype=float32, shape=(17,), low=0, high=1)
  reset            Space(dtype=bool, shape=(), low=False, high=True)
Prefill train dataset.
Prefill eval dataset.
Found existing checkpoint.
Loading checkpoint: /home/ziyu/logdir/ziyu_crafter_cuda_1_seed_1/checkpoint.ckpt
Loaded checkpoint from 35903 seconds ago.
Start training loop.
Starting evaluation at step 26500
Tracing policy function.
Tracing policy function.
Episode has 54 steps and return 2.1.
Tracing policy function.
Tracing train function.
Tracing report function.
Tracing report function.
Tracing report function.
────────────────────────────────── Step 26501 ──────────────────────────────────
eval_episode/length 54 / eval_episode/score 2.1 / eval_episode/reward_rate 0.98 
/ eval_stats/sum_log_reward 2.1 / eval_stats/max_log_achievement_collect_drink 2
/ eval_stats/max_log_achievement_collect_sapling 1 / 
eval_stats/max_log_achievement_place_plant 1 / train/action_mag 16 / 
train/action_max 16 / train/action_mean 6.26 / train/action_min 0 / 
train/action_std 4.28 / train/actor_opt_actor_opt_grad_overflow 0 / 
train/actor_opt_actor_opt_grad_scale 1e4 / train/actor_opt_grad_norm 0.04 / 
train/actor_opt_grad_steps 1.3e4 / train/actor_opt_loss -29.26 / train/adv_mag 
0.53 / train/adv_max 0.39 / train/adv_mean -3.6e-4 / train/adv_min -0.53 / 
train/adv_std 0.06 / train/cont_avg 0.99 / train/cont_loss_mean 5.2e-6 / 
train/cont_loss_std 3.4e-5 / train/cont_neg_acc 1 / train/cont_neg_loss 3.7e-5 /
train/cont_pos_acc 1 / train/cont_pos_loss 5e-6 / train/cont_pred 0.99 / 
train/cont_rate 0.99 / train/dyn_loss_mean 3.31 / train/dyn_loss_std 6.87 / 
train/extr_critic_critic_opt_critic_opt_grad_overflow 0 / 
train/extr_critic_critic_opt_critic_opt_grad_scale 1e4 / 
train/extr_critic_critic_opt_grad_norm 1.07 / 
train/extr_critic_critic_opt_grad_steps 1.3e4 / 
train/extr_critic_critic_opt_loss 1.4e4 / train/extr_critic_mag 6.27 / 
train/extr_critic_max 6.27 / train/extr_critic_mean 2.37 / train/extr_critic_min
-0.56 / train/extr_critic_std 1.49 / train/extr_return_normed_mag 1.43 / 
train/extr_return_normed_max 1.43 / train/extr_return_normed_mean 0.5 / 
train/extr_return_normed_min -0.15 / train/extr_return_normed_std 0.3 / 
train/extr_return_rate 0.82 / train/extr_return_raw_mag 6.98 / 
train/extr_return_raw_max 6.98 / train/extr_return_raw_mean 2.37 / 
train/extr_return_raw_min -0.89 / train/extr_return_raw_std 1.48 / 
train/extr_reward_mag 1.02 / train/extr_reward_max 1.02 / train/extr_reward_mean
0.03 / train/extr_reward_min -0.71 / train/extr_reward_std 0.18 / 
train/image_loss_mean 4.11 / train/image_loss_std 9.25 / train/model_loss_mean 
6.12 / train/model_loss_std 12.06 / train/model_opt_grad_norm 95.16 / 
train/model_opt_grad_steps 1.3e4 / train/model_opt_loss 7650.43 / 
train/model_opt_model_opt_grad_overflow 0 / train/model_opt_model_opt_grad_scale
1250 / train/policy_entropy_mag 2.29 / train/policy_entropy_max 2.29 / 
train/policy_entropy_mean 0.49 / train/policy_entropy_min 0.08 / 
train/policy_entropy_std 0.48 / train/policy_logprob_mag 7.44 / 
train/policy_logprob_max -9.5e-3 / train/policy_logprob_mean -0.5 / 
train/policy_logprob_min -7.44 / train/policy_logprob_std 1.08 / 
train/policy_randomness_mag 0.81 / train/policy_randomness_max 0.81 / 
train/policy_randomness_mean 0.17 / train/policy_randomness_min 0.03 / 
train/policy_randomness_std 0.17 / train/post_ent_mag 39.34 / train/post_ent_max
39.34 / train/post_ent_mean 22.56 / train/post_ent_min 11.57 / 
train/post_ent_std 4.32 / train/prior_ent_mag 67.38 / train/prior_ent_max 67.38 
/ train/prior_ent_mean 26.1 / train/prior_ent_min 13.16 / train/prior_ent_std 
8.51 / train/rep_loss_mean 3.31 / train/rep_loss_std 6.87 / train/reward_avg 
0.01 / train/reward_loss_mean 0.03 / train/reward_loss_std 0.14 / 
train/reward_max_data 1 / train/reward_max_pred 1 / train/reward_neg_acc 1 / 
train/reward_neg_loss 0.02 / train/reward_pos_acc 1 / train/reward_pos_loss 0.67
/ train/reward_pred 0.01 / train/reward_rate 0.02 / 
train/transition_tokens_loss_mean 3.1e-4 / train/transition_tokens_loss_std 
1.2e-5 / train/params_agent/wm/model_opt 2e8 / 
train/params_agent/task_behavior/critic/critic_opt 9.7e6 / 
train/params_agent/task_behavior/ac/actor_opt 9.5e6 / report/cont_avg 0.99 / 
report/cont_loss_mean 4.9e-4 / report/cont_loss_std 0.02 / report/cont_neg_acc 1
/ report/cont_neg_loss 3.9e-5 / report/cont_pos_acc 1 / report/cont_pos_loss 
5e-4 / report/cont_pred 0.99 / report/cont_rate 0.99 / report/dyn_loss_mean 3.2 
/ report/dyn_loss_std 6.8 / report/image_loss_mean 3.64 / report/image_loss_std 
8.3 / report/model_loss_mean 5.6 / report/model_loss_std 11.17 / 
report/post_ent_mag 37.95 / report/post_ent_max 37.95 / report/post_ent_mean 
22.5 / report/post_ent_min 11.46 / report/post_ent_std 4.32 / 
report/prior_ent_mag 67.39 / report/prior_ent_max 67.39 / report/prior_ent_mean 
26 / report/prior_ent_min 13.08 / report/prior_ent_std 8.46 / 
report/rep_loss_mean 3.2 / report/rep_loss_std 6.8 / report/reward_avg 0.01 / 
report/reward_loss_mean 0.03 / report/reward_loss_std 0.21 / 
report/reward_max_data 1 / report/reward_max_pred 1 / report/reward_neg_acc 1 / 
report/reward_neg_loss 0.02 / report/reward_pos_acc 1 / report/reward_pos_loss 
0.67 / report/reward_pred 0.01 / report/reward_rate 0.02 / 
report/transition_tokens_loss_mean 3.2e-4 / report/transition_tokens_loss_std 
1.2e-5 / eval/cont_avg 0.99 / eval/cont_loss_mean 8e-3 / eval/cont_loss_std 0.25
/ eval/cont_neg_acc 0.88 / eval/cont_neg_loss 1.02 / eval/cont_pos_acc 1 / 
eval/cont_pos_loss 2.4e-5 / eval/cont_pred 0.99 / eval/cont_rate 0.99 / 
eval/dyn_loss_mean 22.77 / eval/dyn_loss_std 12.7 / eval/image_loss_mean 36.52 /
eval/image_loss_std 33.06 / eval/model_loss_mean 50.37 / eval/model_loss_std 
37.86 / eval/post_ent_mag 37.77 / eval/post_ent_max 37.77 / eval/post_ent_mean 
26.09 / eval/post_ent_min 10.55 / eval/post_ent_std 4.93 / eval/prior_ent_mag 
67.39 / eval/prior_ent_max 67.39 / eval/prior_ent_mean 33.65 / 
eval/prior_ent_min 11.19 / eval/prior_ent_std 10.09 / eval/rep_loss_mean 22.77 /
eval/rep_loss_std 12.7 / eval/reward_avg 8.1e-3 / eval/reward_loss_mean 0.18 / 
eval/reward_loss_std 1.07 / eval/reward_max_data 1 / eval/reward_max_pred 1 / 
eval/reward_neg_acc 1 / eval/reward_neg_loss 0.1 / eval/reward_pos_acc 0.33 / 
eval/reward_pos_loss 5.84 / eval/reward_pred 1.1e-3 / eval/reward_rate 0.01 / 
eval/transition_tokens_loss_mean 3.1e-4 / eval/transition_tokens_loss_std 9.8e-6
/ replay/size 5.9e4 / replay/inserts 0 / replay/samples 112 / 
replay/insert_wait_avg nan / replay/insert_wait_frac nan / 
replay/sample_wait_avg 1.9e-6 / replay/sample_wait_frac 1 / eval_replay/size 
2556 / eval_replay/inserts 0 / eval_replay/samples 112 / 
eval_replay/insert_wait_avg nan / eval_replay/insert_wait_frac nan / 
eval_replay/sample_wait_avg 2.3e-6 / eval_replay/sample_wait_frac 1 / 
timer/duration 158.4 / timer/replay._sample_count 112 / 
timer/replay._sample_total 11.18 / timer/replay._sample_frac 0.07 / 
timer/replay._sample_avg 0.1 / timer/replay._sample_min 0.05 / 
timer/replay._sample_max 0.16 / timer/agent.policy_count 56 / 
timer/agent.policy_total 7.64 / timer/agent.policy_frac 0.05 / 
timer/agent.policy_avg 0.14 / timer/agent.policy_min 8.9e-3 / 
timer/agent.policy_max 5.1 / timer/env.step_count 1 / timer/env.step_total 1.42 
/ timer/env.step_frac 8.9e-3 / timer/env.step_avg 1.42 / timer/env.step_min 1.42
/ timer/env.step_max 1.42 / timer/dataset_train_count 1 / 
timer/dataset_train_total 9.4e-5 / timer/dataset_train_frac 5.9e-7 / 
timer/dataset_train_avg 9.4e-5 / timer/dataset_train_min 9.4e-5 / 
timer/dataset_train_max 9.4e-5 / timer/agent.train_count 1 / 
timer/agent.train_total 101.88 / timer/agent.train_frac 0.64 / 
timer/agent.train_avg 101.88 / timer/agent.train_min 101.88 / 
timer/agent.train_max 101.88 / timer/agent.report_count 2 / 
timer/agent.report_total 22.64 / timer/agent.report_frac 0.14 / 
timer/agent.report_avg 11.32 / timer/agent.report_min 5.97 / 
timer/agent.report_max 16.67 / timer/dataset_eval_count 1 / 
timer/dataset_eval_total 1.1e-4 / timer/dataset_eval_frac 6.8e-7 / 
timer/dataset_eval_avg 1.1e-4 / timer/dataset_eval_min 1.1e-4 / 
timer/dataset_eval_max 1.1e-4
wandb: WARNING Found log directory outside of given root_logdir, dropping given root_logdir for event file in /home/ziyu/logdir/ziyu_crafter_cuda_1_seed_1
