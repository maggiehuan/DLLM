Encoder CNN shapes: {'image': (64, 64, 3)}
Encoder MLP shapes: {'transition_tokens': (384,)}
Decoder CNN shapes: {'image': (64, 64, 3)}
Decoder MLP shapes: {'transition_tokens': (384,)}
JAX devices (1): [cuda(id=0)]
Policy devices: cuda:0
Train devices:  cuda:0
Tracing train function.
no rnd data in data
Optimizer model_opt has 197,057,283 variables.
Optimizer actor_opt has 9,464,849 variables.
Optimizer critic_opt has 9,708,799 variables.
Logdir /home/ziyu/logdir/ziyu_crafter_cuda_0_seed_0
Observation space:
  image            Space(dtype=uint8, shape=(64, 64, 3), low=0, high=255)
  transition_tokens Space(dtype=uint32, shape=(384,), low=0, high=4294967295)
  goal_tokens      Space(dtype=uint32, shape=(5, 384), low=0, high=4294967295)
  goal_id          Space(dtype=uint32, shape=(5,), low=0, high=4294967295)
  reward           Space(dtype=float32, shape=(), low=-inf, high=inf)
  is_first         Space(dtype=bool, shape=(), low=False, high=True)
  is_last          Space(dtype=bool, shape=(), low=False, high=True)
  is_terminal      Space(dtype=bool, shape=(), low=False, high=True)
  log_reward       Space(dtype=float32, shape=(1,), low=-inf, high=inf)
  log_achievement_collect_coal Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_collect_diamond Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_collect_drink Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_collect_iron Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_collect_sapling Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_collect_stone Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_collect_wood Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_defeat_skeleton Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_defeat_zombie Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_eat_cow Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_eat_plant Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_make_iron_pickaxe Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_make_iron_sword Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_make_stone_pickaxe Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_make_stone_sword Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_make_wood_pickaxe Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_make_wood_sword Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_place_furnace Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_place_plant Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_place_stone Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_place_table Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
  log_achievement_wake_up Space(dtype=int32, shape=(), low=-2147483648, high=2147483647)
Action space:
  action           Space(dtype=float32, shape=(17,), low=0, high=1)
  reset            Space(dtype=bool, shape=(), low=False, high=True)
Prefill train dataset.
Prefill eval dataset.
Found existing checkpoint.
Loading checkpoint: /home/ziyu/logdir/ziyu_crafter_cuda_0_seed_0/checkpoint.ckpt
Loaded checkpoint from 1271 seconds ago.
Start training loop.
Starting evaluation at step 4500
Tracing policy function.
Tracing policy function.
Traceback (most recent call last):
  File "/home/ziyu/code/side_codes/Dynamic_model/DLLM-ziyu/LID-rnd/train.py", line 229, in <module>
    main()
  File "/home/ziyu/code/side_codes/Dynamic_model/DLLM-ziyu/LID-rnd/train.py", line 69, in main
    embodied.run.train_eval(
  File "/home/ziyu/code/side_codes/Dynamic_model/DLLM-ziyu/LID-rnd/embodied/run/train_eval.py", line 145, in train_eval
    driver_eval(policy_eval, episodes=max(len(eval_env), args.eval_eps))
  File "/home/ziyu/code/side_codes/Dynamic_model/DLLM-ziyu/LID-rnd/embodied/core/driver.py", line 42, in __call__
    step, episode = self._step(policy, step, episode)
  File "/home/ziyu/code/side_codes/Dynamic_model/DLLM-ziyu/LID-rnd/embodied/core/driver.py", line 47, in _step
    obs = self._env.step(acts)
  File "/home/ziyu/code/side_codes/Dynamic_model/DLLM-ziyu/LID-rnd/embodied/core/batch.py", line 34, in step
    obs = [ob() for ob in obs]
  File "/home/ziyu/code/side_codes/Dynamic_model/DLLM-ziyu/LID-rnd/embodied/core/batch.py", line 34, in <listcomp>
    obs = [ob() for ob in obs]
  File "/home/ziyu/code/side_codes/Dynamic_model/DLLM-ziyu/LID-rnd/embodied/core/worker.py", line 230, in __call__
    self._result = self._receive(self._callid)
  File "/home/ziyu/code/side_codes/Dynamic_model/DLLM-ziyu/LID-rnd/embodied/core/worker.py", line 174, in _receive
    message, callid, payload = self._pipe.recv()
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt
Error in sys.excepthook:
Traceback (most recent call last):
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/site-packages/rich/console.py", line 1700, in print
    extend(render(renderable, render_options))
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/site-packages/rich/console.py", line 1336, in render
    yield from self.render(render_output, _options)
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/site-packages/rich/console.py", line 1332, in render
    for render_output in iter_render:
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/site-packages/rich/constrain.py", line 29, in __rich_console__
    yield from console.render(self.renderable, child_options)
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/site-packages/rich/console.py", line 1332, in render
    for render_output in iter_render:
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/site-packages/rich/panel.py", line 220, in __rich_console__
    lines = console.render_lines(renderable, child_options, style=style)
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/site-packages/rich/console.py", line 1372, in render_lines
    lines = list(
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/site-packages/rich/segment.py", line 292, in split_and_crop_lines
    for segment in segments:
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/site-packages/rich/console.py", line 1332, in render
    for render_output in iter_render:
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/site-packages/rich/padding.py", line 97, in __rich_console__
    lines = console.render_lines(
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/site-packages/rich/console.py", line 1372, in render_lines
    lines = list(
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/site-packages/rich/segment.py", line 292, in split_and_crop_lines
    for segment in segments:
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/site-packages/rich/console.py", line 1336, in render
    yield from self.render(render_output, _options)
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/site-packages/rich/console.py", line 1332, in render
    for render_output in iter_render:
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/site-packages/rich/syntax.py", line 621, in __rich_console__
    segments = Segments(self._get_syntax(console, options))
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/site-packages/rich/segment.py", line 668, in __init__
    self.segments = list(segments)
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/site-packages/rich/syntax.py", line 649, in _get_syntax
    text = self.highlight(processed_code, self.line_range)
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/site-packages/rich/syntax.py", line 522, in highlight
    text.append_tokens(tokens_to_spans())
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/site-packages/rich/text.py", line 1038, in append_tokens
    for content, style in tokens:
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/site-packages/rich/syntax.py", line 508, in tokens_to_spans
    _token_type, token = next(tokens)
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/site-packages/rich/syntax.py", line 494, in line_tokenize
    for token_type, token in lexer.get_tokens(code):
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/site-packages/pygments/lexer.py", line 259, in streamer
    for _, t, v in self.get_tokens_unprocessed(text):
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/site-packages/pygments/lexer.py", line 702, in get_tokens_unprocessed
    m = rexmatch(text, pos)
KeyboardInterrupt
Original exception was:
Traceback (most recent call last):
  File "/home/ziyu/code/side_codes/Dynamic_model/DLLM-ziyu/LID-rnd/train.py", line 229, in <module>
    main()
  File "/home/ziyu/code/side_codes/Dynamic_model/DLLM-ziyu/LID-rnd/train.py", line 69, in main
    embodied.run.train_eval(
  File "/home/ziyu/code/side_codes/Dynamic_model/DLLM-ziyu/LID-rnd/embodied/run/train_eval.py", line 145, in train_eval
    driver_eval(policy_eval, episodes=max(len(eval_env), args.eval_eps))
  File "/home/ziyu/code/side_codes/Dynamic_model/DLLM-ziyu/LID-rnd/embodied/core/driver.py", line 42, in __call__
    step, episode = self._step(policy, step, episode)
  File "/home/ziyu/code/side_codes/Dynamic_model/DLLM-ziyu/LID-rnd/embodied/core/driver.py", line 47, in _step
    obs = self._env.step(acts)
  File "/home/ziyu/code/side_codes/Dynamic_model/DLLM-ziyu/LID-rnd/embodied/core/batch.py", line 34, in step
    obs = [ob() for ob in obs]
  File "/home/ziyu/code/side_codes/Dynamic_model/DLLM-ziyu/LID-rnd/embodied/core/batch.py", line 34, in <listcomp>
    obs = [ob() for ob in obs]
  File "/home/ziyu/code/side_codes/Dynamic_model/DLLM-ziyu/LID-rnd/embodied/core/worker.py", line 230, in __call__
    self._result = self._receive(self._callid)
  File "/home/ziyu/code/side_codes/Dynamic_model/DLLM-ziyu/LID-rnd/embodied/core/worker.py", line 174, in _receive
    message, callid, payload = self._pipe.recv()
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/multiprocessing/connection.py", line 414, in _recv_bytes
    buf = self._recv(4)
  File "/home/ziyu/anaconda3/envs/jaxpy39/lib/python3.10/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt